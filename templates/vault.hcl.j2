{% if vault_backend is defined %}
backend "{{ vault_backend.backend }}" {
  address = "{{ vault_backend.address }}"
  path = "{{ vault_backend.path }}"
}
{% else %}
backend "consul" {
  address = "127.0.0.1:8500"
  path = "vault"
}
{% endif %}

{% if vault_listener is defined %}
listener "{{ vault_listener.listener }}" {
  address = "{{ vault_listener.address }}"
{%   if vault_listener.tls_disable is defined %}
{%     if vault_listener.tls_disable %}
  tls_disable = 1
{%     else %}
  tls_disable = 0
{%     endif %}
{%   else %}
  tls_disable = 1
{%   endif %}
}
{% else %}
listener "tcp" {
  address = "127.0.0.1:8200"
  tls_disable = 1
}
{% endif %}

{% if vault_telemetry is defined %}
telemetry {
  statsite_address = "{{ vault_telemetry.statsite_address }}"
{%   if vault_telemetry.disable_hostname is defined %}
{%     if vault_telemetry.disable_hostname %}
  disable_hostname = true
{%     else %}
  disable_hostname = false
{%     endif %}
{%   else %}
  disable_hostname = true
{%   endif %} 
}
{% else %}
telemetry {
  statsite_address = "127.0.0.1:8125"
  disable_hostname = true
}
{% endif %}
